"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,n){if("object"!==_typeof(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===n?String:Number)(t);e=e.call(t,n||"default");if("object"!==_typeof(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}jQuery(function(){var l,u;l=window.jQuery,u=window.Puock,new(function(){function t(){_classCallCheck(this,t),this.init(),this.onAiSubmit(),this.onClearHistory()}return _createClass(t,[{key:"init",value:function(){l(".chat-btn-init").remove(),l(".chat-btn-box").removeClass("d-none")}},{key:"onAiSubmit",value:function(){var c=this;l(".chat-input").on("keydown",function(t){t.ctrlKey&&13===t.which&&l(".chat-submit").click()}),l(".chat-submit").on("click",function(t){var n,e,o,i,r=l(t.currentTarget),t=l(".chat-input"),a=l.trim(t.val());""===a?u.toast("请先输入内容"):(c.putMsg({ai:!1,avatar:aiMetaInfo.userAvatar,content:a}),n=c.putMsg({ai:!0,avatar:aiMetaInfo.aiAvatar,content:"",load:!0}),r.attr("disabled",!0),t.val(""),e=l("#"+n),o=e.find(".content-box"),i=function(){e.find(".cursor-blink-after").removeClass("cursor-blink-after"),r.attr("disabled",!1)},l.post(aiMetaInfo.url,{text:a},function(t){o.html(t),i(),l("html,body").stop().animate({scrollTop:l(document).height()},200)}).fail(function(t){i(),console.error(t),o.html("<code>请求异常</code>")}))})}},{key:"putMsg",value:function(t){var n="chat-"+(new Date).getTime()+""+Math.floor(1e3*Math.random())+"",t='<div id="'.concat(n,'" class="chat-item is-').concat(t.ai?"ai":"user",'">\n                                <div class="row">\n                                    <div class="col-auto">\n                                        <img src="').concat(t.avatar,'" class="avatar md-avatar" alt="avatar">\n                                    </div>\n                                    <div class="col fs14 content-box ').concat(t.ai?"cursor-blink-after":"",'">').concat(t.content,"</div>\n                                </div>\n                            </div>");return l(".chats").append(t),n}},{key:"onClearHistory",value:function(){l(".chat-clear-history").on("click",function(){layer.confirm("确定要清空历史记录吗？",{btn:["确定","取消"]},function(t){layer.close(t),l(".chats").html("")})})}}]),t}())});